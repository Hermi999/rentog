
- own_listing_class = ""
- if @current_user && listing.author.id == @current_user.get_company.id
  - own_listing_class = "own_listing"

- if listing.price
  - price_text = nil
  - if listing.quantity.present?
    - price_text = t("listings.form.price.per") + " " + listing.quantity
  - elsif listing.unit_type
    - price_text = price_quantity_per_unit(listing)



- frontpage_fragment_cache("list_item", listing) do
  .home-list-item{:class => "#{own_listing_class}"}
    / Image
    .home-list-image-wrapper
      - if listing.listing_images.size > 0
        - img_link = listing.listing_images.first[:small_3x2]

      = link_to listing_path(listing.url), :class => "home-list-image-container-desktop" do
        = image_tag img_link, {:alt => "Image missing...", :class => "home-list-image"}

      - if listing.listing_images.size > 0
        - img_link = listing.listing_images.first[:thumb]

      = link_to listing_path(listing.url), :class => "home-list-image-container-mobile" do
        = image_tag img_link, {:alt => "Image missing...", :class => "home-list-image"}

    .home-list-listing-details-wrapper
      .row
        /Title
        .colFix-12{style: "padding-left: 0.5em;"}
          %h2.home-list-title
            = link_to listing_path(listing.url) do
              = listing.title
              - if @current_community.show_category_in_listing_list
                %a.home-share-type-link{:href => root(:transaction_type => shape_name_map[listing.listing_shape_id], :view => :list)}
                  = icon_tag(listing.icon_name, ["icon-fix"])
                  = shape_name(listing)


      / Author and/or Authors location + Merkzettel
      .row.author-and-location
        .colFix-9
          - country = Maybe(ISO3166::Country.find_country_by_name(Maybe(listing.author.location_address).split(",").last.gsub(/[^a-zÖÜÄüöä\s]/i, '').strip.or_else(nil))).translation(I18n.locale).or_else("n/a")

          - if @restrictedMarketplace
            = link_to(person_path(id: listing.author.username), :class => "home-list-author-name") do
              = PersonViewUtils::person_entity_display_name(listing.author, @current_community.name_display_type)
          %span.hide-on-mobile{style: "display: inline;"}
            %b= t(".from")
            = country

          - if testimonials_in_use
            %span.home-list-author-reviews.hide-on-mobile
              - if listing.author.num_of_reviews > 0
                = "("
                = icon_tag("testimonial")
                = pluralize(listing.author.num_of_reviews, t(".review"), t(".reviews"))
                = ")"

        - if !@restrictedMarketplace
          .colFix-3{style: "padding: 0px; text-align:right;"}
            %a= t(".wishlist").html_safe


      / Shipment to
      .row.hide-on-mobile{style: "font-size: 0.8em; line-height: 1.3em; margin: 4px 0 7px 0;"}
        .colFix-8{style: "max-height: 32px; overflow: hidden; min-height: 32px;"}
          %b= t(".shipment_to")
          - if(countries = get_listing_shipment_to(listing))
            = countries


      / Share, Condition & Price
      .row#share_cond_price
        / Share
        .colFix-4.hide-on-tiny-mobile
          .home-list-share= t('homepage.share')
          = render :partial => "share_dialog", :locals => {listing: listing, view: "list"}

        / Condition
        .colFix-4
          - if (cond = get_listing_condition(listing))
            .home-list-type{:class => "grid-item-type-" + cond[:condition].to_s}= cond[:title] || "n/a"

        .colFix-4.show-on-tiny-mobile

        / Price
        .colFix-4{style: "font-size: 0.8em; margin-top:0px; padding-right: 0px;"}
          .home-list-price
            - if listing.price

              .home-list-price-quantity.hide-on-mobile{:title => price_text}
                = price_text || "&nbsp".html_safe

              .home-list-price-value
                %span{style: "font-size: 0.6em;"}= currency_symbol
                = " " + humanized_money(listing.price).upcase

              .home-list-price-quantity-mobile{:title => price_text}
                = price_text

            - else
              .home-list-listing-shape-value
                = shape_name(listing)
